"use strict";(()=>{var e={};e.id=442,e.ids=[442],e.modules={97352:e=>{e.exports=require("@prisma/client/runtime/library.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},73260:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>h,originalPathname:()=>x,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>g});var s={};t.r(s),t.d(s,{GET:()=>GET,PUT:()=>PUT,dynamic:()=>d,runtime:()=>c});var a=t(10884),i=t(16132),o=t(95798),n=t(96810),u=t(8192);let l=new n.PrismaClient;async function GET(e){try{let r=e.headers.get("authorization")?.replace("Bearer ","");if(!r)return o.Z.json({success:!1,message:"Authentication required"},{status:401});let t=(0,u.WX)(r);if(!t)return o.Z.json({success:!1,message:"Invalid token"},{status:401});let s=await l.user.findUnique({where:{id:t.id},select:{id:!0,email:!0,username:!0,firstName:!0,lastName:!0,bio:!0,website:!0,location:!0,avatar:!0,createdAt:!0,updatedAt:!0,isEmailVerified:!0}});if(!s)return o.Z.json({success:!1,message:"User not found"},{status:404});return o.Z.json({success:!0,data:s})}catch(e){return console.error("Profile fetch error:",e),o.Z.json({success:!1,message:"Internal server error"},{status:500})}}async function PUT(e){try{let r=e.headers.get("authorization")?.replace("Bearer ","");if(!r)return o.Z.json({success:!1,message:"Authentication required"},{status:401});let t=(0,u.WX)(r);if(!t)return o.Z.json({success:!1,message:"Invalid token"},{status:401});let s=await e.json(),{firstName:a,lastName:i,username:n,bio:c,website:d,location:p}=s;if(n){let e=await l.user.findFirst({where:{username:n.toLowerCase(),id:{not:t.id}}});if(e)return o.Z.json({success:!1,message:"Username is already taken"},{status:400})}let m=await l.user.update({where:{id:t.id},data:{firstName:a||null,lastName:i||null,username:n?n.toLowerCase():null,bio:c||null,website:d||null,location:p||null,updatedAt:new Date},select:{id:!0,email:!0,username:!0,firstName:!0,lastName:!0,bio:!0,website:!0,location:!0,avatar:!0,createdAt:!0,updatedAt:!0,isEmailVerified:!0}});return o.Z.json({success:!0,message:"Profile updated successfully",data:m})}catch(e){return console.error("Profile update error:",e),o.Z.json({success:!1,message:"Internal server error"},{status:500})}}let c="nodejs",d="force-dynamic",p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/profile/route",pathname:"/api/profile",filename:"route",bundlePath:"app/api/profile/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/profile/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:w,headerHooks:h,staticGenerationBailout:g}=p,x="/api/profile/route"}};var r=require("../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[729,6449,5798,6810,8752,8192],()=>__webpack_exec__(73260));module.exports=t})();