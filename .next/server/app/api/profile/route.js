"use strict";(()=>{var e={};e.id=442,e.ids=[442],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},57074:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>h,originalPathname:()=>j,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>g});var s={};t.r(s),t.d(s,{GET:()=>GET,PUT:()=>PUT,dynamic:()=>d,runtime:()=>c});var a=t(10884),i=t(16132),n=t(95798),o=t(53524),u=t(8192);let l=new o.PrismaClient;async function GET(e){try{let r=e.headers.get("authorization")?.replace("Bearer ","");if(!r)return n.Z.json({success:!1,message:"Authentication required"},{status:401});let t=(0,u.WX)(r);if(!t)return n.Z.json({success:!1,message:"Invalid token"},{status:401});let s=await l.user.findUnique({where:{id:t.id},select:{id:!0,email:!0,username:!0,firstName:!0,lastName:!0,bio:!0,website:!0,location:!0,avatar:!0,createdAt:!0,updatedAt:!0,isEmailVerified:!0}});if(!s)return n.Z.json({success:!1,message:"User not found"},{status:404});return n.Z.json({success:!0,data:s})}catch(e){return console.error("Profile fetch error:",e),n.Z.json({success:!1,message:"Internal server error"},{status:500})}}async function PUT(e){try{let r=e.headers.get("authorization")?.replace("Bearer ","");if(!r)return n.Z.json({success:!1,message:"Authentication required"},{status:401});let t=(0,u.WX)(r);if(!t)return n.Z.json({success:!1,message:"Invalid token"},{status:401});let s=await e.json(),{firstName:a,lastName:i,username:o,bio:c,website:d,location:p}=s;if(o){let e=await l.user.findFirst({where:{username:o.toLowerCase(),id:{not:t.id}}});if(e)return n.Z.json({success:!1,message:"Username is already taken"},{status:400})}let m=await l.user.update({where:{id:t.id},data:{firstName:a||null,lastName:i||null,username:o?o.toLowerCase():null,bio:c||null,website:d||null,location:p||null,updatedAt:new Date},select:{id:!0,email:!0,username:!0,firstName:!0,lastName:!0,bio:!0,website:!0,location:!0,avatar:!0,createdAt:!0,updatedAt:!0,isEmailVerified:!0}});return n.Z.json({success:!0,message:"Profile updated successfully",data:m})}catch(e){return console.error("Profile update error:",e),n.Z.json({success:!1,message:"Internal server error"},{status:500})}}let c="nodejs",d="force-dynamic",p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/profile/route",pathname:"/api/profile",filename:"route",bundlePath:"app/api/profile/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/profile/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:w,headerHooks:h,staticGenerationBailout:g}=p,j="/api/profile/route"}};var r=require("../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4736,8592],()=>__webpack_exec__(57074));module.exports=t})();