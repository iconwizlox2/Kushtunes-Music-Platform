"use strict";(()=>{var e={};e.id=748,e.ids=[748],e.modules={3524:e=>{e.exports=require("@prisma/client")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},3706:(e,s,r)=>{r.r(s),r.d(s,{headerHooks:()=>p,originalPathname:()=>g,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var i={};r.r(i),r.d(i,{POST:()=>POST,PUT:()=>PUT});var a=r(884),t=r(6132),n=r(5798),o=r(3524),u=r(8192);let l=new o.PrismaClient;async function POST(e){try{let{email:s}=await e.json();if(!s)return n.Z.json({success:!1,message:"Email is required"},{status:400});let r=await l.user.findUnique({where:{email:s.toLowerCase()}});if(!r)return n.Z.json({success:!1,message:"User not found"},{status:404});if(r.isVerified)return n.Z.json({success:!1,message:"Email is already verified"},{status:400});let i=(0,u.VB)(),a=`${process.env.NEXTAUTH_URL||"http://localhost:3000"}/verify-email?token=${i}&email=${encodeURIComponent(s)}`;return console.log("Email verification URL:",a),n.Z.json({success:!0,message:"Verification email sent successfully",data:{verificationUrl:a,email:r.email}})}catch(e){return console.error("Send verification error:",e),n.Z.json({success:!1,message:"Failed to send verification email"},{status:500})}}async function PUT(e){try{let{token:s,email:r}=await e.json();if(!s||!r)return n.Z.json({success:!1,message:"Token and email are required"},{status:400});let i=await l.user.findUnique({where:{email:r.toLowerCase()}});if(!i)return n.Z.json({success:!1,message:"User not found"},{status:404});if(i.isVerified)return n.Z.json({success:!1,message:"Email is already verified"},{status:400});if(s.length<10)return n.Z.json({success:!1,message:"Invalid verification token"},{status:400});return await l.user.update({where:{id:i.id},data:{isVerified:!0}}),n.Z.json({success:!0,message:"Email verified successfully",data:{user:{id:i.id,email:i.email,username:i.username,isVerified:!0}}})}catch(e){return console.error("Email verification error:",e),n.Z.json({success:!1,message:"Email verification failed"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/auth/verify-email/route",pathname:"/api/auth/verify-email",filename:"route",bundlePath:"app/api/auth/verify-email/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/auth/verify-email/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:f,headerHooks:p,staticGenerationBailout:v}=c,g="/api/auth/verify-email/route"}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[729,798,752,192],()=>__webpack_exec__(3706));module.exports=r})();