"use strict";exports.id=192,exports.ids=[192],exports.modules={8192:(e,s,a)=>{a.d(s,{Gv:()=>verifyPassword,LC:()=>generateSessionToken,RA:()=>generateToken,VB:()=>generateEmailVerificationToken,WX:()=>verifyToken,c_:()=>hashPassword,eW:()=>isValidPassword,oA:()=>extractTokenFromHeader,py:()=>createAuthResponse,rh:()=>isValidUsername,vV:()=>isValidEmail});var t=a(5764),r=a(6721),n=a.n(r),i=a(6113);let o=process.env.JWT_SECRET||"your-super-secret-jwt-key-change-in-production";async function hashPassword(e){return await t.ZP.hash(e,12)}async function verifyPassword(e,s){return await t.ZP.compare(e,s)}function generateToken(e){return n().sign(e,o,{expiresIn:"7d"})}function verifyToken(e){try{return n().verify(e,o)}catch(e){return null}}function generateSessionToken(){return(0,i.randomBytes)(32).toString("hex")}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function isValidPassword(e){return e.length<8?{valid:!1,message:"Password must be at least 8 characters long"}:/(?=.*[a-z])/.test(e)?/(?=.*[A-Z])/.test(e)?/(?=.*\d)/.test(e)?/(?=.*[@$!%*?&])/.test(e)?{valid:!0}:{valid:!1,message:"Password must contain at least one special character (@$!%*?&)"}:{valid:!1,message:"Password must contain at least one number"}:{valid:!1,message:"Password must contain at least one uppercase letter"}:{valid:!1,message:"Password must contain at least one lowercase letter"}}function isValidUsername(e){return e.length<3?{valid:!1,message:"Username must be at least 3 characters long"}:e.length>20?{valid:!1,message:"Username must be less than 20 characters long"}:/^[a-zA-Z0-9_]+$/.test(e)?{valid:!0}:{valid:!1,message:"Username can only contain letters, numbers, and underscores"}}function generateEmailVerificationToken(){return(0,i.randomBytes)(32).toString("hex")}function extractTokenFromHeader(e){if(!e)return null;let s=e.split(" ");return 2!==s.length||"Bearer"!==s[0]?null:s[1]}function createAuthResponse(e,s){return{success:!0,message:"Authentication successful",data:{user:{id:e.id,email:e.email,username:e.username||e.email.split("@")[0],firstName:e.firstName,lastName:e.lastName,avatar:e.avatar,bio:e.bio,website:e.website,role:e.role,isVerified:e.isVerified,createdAt:e.createdAt},token:s,expiresAt:new Date(Date.now()+6048e5)}}}}};