"use strict";(()=>{var e={};e.id=338,e.ids=[338],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},52825:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>v,originalPathname:()=>x,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>w});var t={};s.r(t),s.d(t,{POST:()=>POST});var a=s(10884),i=s(16132),u=s(95798),o=s(53524),n=s(8192);let d=new o.PrismaClient;async function POST(e,{params:r}){try{let s=e.headers.get("authorization");if(!s)return u.Z.json({success:!1,message:"Authorization header required"},{status:401});let t=s.replace("Bearer ",""),a=(0,n.WX)(t);if(!a)return u.Z.json({success:!1,message:"Invalid token"},{status:401});if("ADMIN"!==a.role)return u.Z.json({success:!1,message:"Admin access required"},{status:403});let{id:i}=r,{approved:o,notes:l}=await e.json(),p=await d.release.update({where:{id:i},data:{status:o?"APPROVED":"REJECTED",updatedAt:new Date}});return o&&await Promise.all(["Spotify","Apple Music","Amazon Music","YouTube Music","Tidal","Deezer"].map(e=>d.delivery.create({data:{releaseId:i,store:e,status:"SUBMITTED",submittedAt:new Date,notes:l||"Approved by admin"}}))),u.Z.json({success:!0,message:`Release ${o?"approved":"rejected"} successfully`,data:{id:p.id,status:p.status}})}catch(e){return console.error("Review release error:",e),u.Z.json({success:!1,message:"Internal server error"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/releases/[id]/review/route",pathname:"/api/admin/releases/[id]/review",filename:"route",bundlePath:"app/api/admin/releases/[id]/review/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/admin/releases/[id]/review/route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:p,staticGenerationAsyncStorage:c,serverHooks:m,headerHooks:v,staticGenerationBailout:w}=l,x="/api/admin/releases/[id]/review/route"}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[4736,8592],()=>__webpack_exec__(52825));module.exports=s})();