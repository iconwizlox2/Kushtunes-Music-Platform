"use strict";(()=>{var e={};e.id=2748,e.ids=[2748],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},86178:(e,s,i)=>{i.r(s),i.d(s,{headerHooks:()=>g,originalPathname:()=>y,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>h});var r={};i.r(r),i.d(r,{POST:()=>POST,PUT:()=>PUT,dynamic:()=>m,runtime:()=>c});var a=i(10884),t=i(16132),n=i(95798),o=i(53524),u=i(8192);let l=new o.PrismaClient,c="nodejs",m="force-dynamic";async function POST(e){try{let{email:s}=await e.json();if(!s)return n.Z.json({success:!1,message:"Email is required"},{status:400});let i=await l.user.findUnique({where:{email:s.toLowerCase()}});if(!i)return n.Z.json({success:!1,message:"User not found"},{status:404});if(i.isEmailVerified)return n.Z.json({success:!1,message:"Email is already verified"},{status:400});let r=(0,u.VB)(),a=`${process.env.NEXTAUTH_URL||"http://localhost:3000"}/verify-email?token=${r}&email=${encodeURIComponent(s)}`;return console.log("Email verification URL:",a),n.Z.json({success:!0,message:"Verification email sent successfully",data:{verificationUrl:a,email:i.email}})}catch(e){return console.error("Send verification error:",e),n.Z.json({success:!1,message:"Failed to send verification email"},{status:500})}}async function PUT(e){try{let{token:s,email:i}=await e.json();if(!s||!i)return n.Z.json({success:!1,message:"Token and email are required"},{status:400});let r=await l.user.findUnique({where:{email:i.toLowerCase()}});if(!r)return n.Z.json({success:!1,message:"User not found"},{status:404});if(r.isEmailVerified)return n.Z.json({success:!1,message:"Email is already verified"},{status:400});if(s.length<10)return n.Z.json({success:!1,message:"Invalid verification token"},{status:400});return await l.user.update({where:{id:r.id},data:{isEmailVerified:!0}}),n.Z.json({success:!0,message:"Email verified successfully",data:{user:{id:r.id,email:r.email,username:r.username,isEmailVerified:!0}}})}catch(e){return console.error("Email verification error:",e),n.Z.json({success:!1,message:"Email verification failed"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/auth/verify-email/route",pathname:"/api/auth/verify-email",filename:"route",bundlePath:"app/api/auth/verify-email/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/auth/verify-email/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:p,serverHooks:v,headerHooks:g,staticGenerationBailout:h}=d,y="/api/auth/verify-email/route"}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),i=s.X(0,[4736,8592],()=>__webpack_exec__(86178));module.exports=i})();