"use strict";(()=>{var e={};e.id=3811,e.ids=[3811],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},17173:(e,s,r)=>{r.r(s),r.d(s,{headerHooks:()=>g,originalPathname:()=>x,requestAsyncStorage:()=>w,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>h});var t={};r.r(t),r.d(t,{PUT:()=>PUT,dynamic:()=>c,runtime:()=>p});var a=r(10884),o=r(16132),u=r(95798),i=r(53524),n=r(8192);let d=new i.PrismaClient;async function PUT(e){try{let s=e.headers.get("authorization")?.replace("Bearer ","");if(!s)return u.Z.json({success:!1,message:"Authentication required"},{status:401});let r=(0,n.WX)(s);if(!r)return u.Z.json({success:!1,message:"Invalid token"},{status:401});let t=await e.json(),{currentPassword:a,newPassword:o}=t;if(!a||!o)return u.Z.json({success:!1,message:"Current password and new password are required"},{status:400});let i=await d.user.findUnique({where:{id:r.id},select:{id:!0,password:!0}});if(!i)return u.Z.json({success:!1,message:"User not found"},{status:404});if(!i.password)return u.Z.json({success:!1,message:"No password set for this account"},{status:400});let p=await (0,n.Gv)(a,i.password);if(!p)return u.Z.json({success:!1,message:"Current password is incorrect"},{status:400});if(o.length<8)return u.Z.json({success:!1,message:"New password must be at least 8 characters long"},{status:400});let c=await (0,n.c_)(o);return await d.user.update({where:{id:r.id},data:{password:c,updatedAt:new Date}}),u.Z.json({success:!0,message:"Password updated successfully"})}catch(e){return console.error("Password update error:",e),u.Z.json({success:!1,message:"Internal server error"},{status:500})}}let p="nodejs",c="force-dynamic",l=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/profile/password/route",pathname:"/api/profile/password",filename:"route",bundlePath:"app/api/profile/password/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/profile/password/route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:w,staticGenerationAsyncStorage:m,serverHooks:f,headerHooks:g,staticGenerationBailout:h}=l,x="/api/profile/password/route"}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[4736,8592],()=>__webpack_exec__(17173));module.exports=r})();