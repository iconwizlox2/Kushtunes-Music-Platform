(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{578:function(e,s,a){Promise.resolve().then(a.bind(a,8166))},8166:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ProfilePage}});var t=a(7437),r=a(2265),l=a(1396),n=a.n(l),i=a(1413),c=a(9162),d=a(6108);function ProfilePage(){let[e,s]=(0,r.useState)(null),[a,l]=(0,r.useState)(!0),[o,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(null),[u,p]=(0,r.useState)(null),[f,j]=(0,r.useState)("profile"),[N,g]=(0,r.useState)(!1),[b,y]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[P,k]=(0,r.useState)({firstName:"",lastName:"",username:"",bio:"",website:"",location:""}),[S,C]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{let loadProfile=async()=>{try{let e=localStorage.getItem("kushtunes_token");if(!e){window.location.href="/login";return}let a=await fetch("/api/auth",{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();if(e.success){let a=e.data.user;s(a),k({firstName:a.firstName||"",lastName:a.lastName||"",username:a.username||"",bio:a.bio||"",website:a.website||"",location:a.location||""})}}else window.location.href="/login"}catch(e){console.error("Profile load error:",e),h("Failed to load profile")}finally{l(!1)}};loadProfile()},[]);let handleProfileUpdate=async e=>{e.preventDefault(),m(!0),h(null),p(null);try{let e=localStorage.getItem("kushtunes_token"),a=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(P)}),t=await a.json();t.success?(p("Profile updated successfully!"),s(t.data)):h(t.message||"Failed to update profile")}catch(e){console.error("Profile update error:",e),h("Failed to update profile")}finally{m(!1)}},handlePasswordUpdate=async e=>{if(e.preventDefault(),m(!0),h(null),p(null),S.newPassword!==S.confirmPassword){h("New passwords do not match"),m(!1);return}try{let e=localStorage.getItem("kushtunes_token"),s=await fetch("/api/profile/password",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({currentPassword:S.currentPassword,newPassword:S.newPassword})}),a=await s.json();a.success?(p("Password updated successfully!"),C({currentPassword:"",newPassword:"",confirmPassword:""})):h(a.message||"Failed to update password")}catch(e){console.error("Password update error:",e),h("Failed to update password")}finally{m(!1)}},handleAvatarUpload=async e=>{try{let a=localStorage.getItem("kushtunes_token"),t=new FormData;t.append("avatar",e);let r=await fetch("/api/profile/avatar",{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:t}),l=await r.json();l.success?(p("Avatar updated successfully!"),s(e=>e?{...e,avatar:l.data.avatarUrl}:null)):h(l.message||"Failed to update avatar")}catch(e){console.error("Avatar upload error:",e),h("Failed to update avatar")}};return a?(0,t.jsx)(i.o,{children:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(c.TK,{})})}):e?(0,t.jsx)(i.o,{children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile Settings"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your account information and preferences"})]}),u&&(0,t.jsx)("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-md p-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(d.nQ,{className:"h-5 w-5 text-green-500 mr-2"}),(0,t.jsx)("p",{className:"text-sm text-green-700",children:u})]})}),x&&(0,t.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(d.LP,{className:"h-5 w-5 text-red-500 mr-2"}),(0,t.jsx)("p",{className:"text-sm text-red-700",children:x})]})}),(0,t.jsx)(c.ZH,{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsxs)("div",{className:"relative",children:[e.avatar?(0,t.jsx)("img",{src:e.avatar,alt:"Profile",className:"h-20 w-20 rounded-full object-cover"}):(0,t.jsx)("div",{className:"h-20 w-20 rounded-full bg-gray-200 flex items-center justify-center",children:(0,t.jsx)(d.tB,{className:"h-10 w-10 text-gray-400"})}),(0,t.jsxs)("label",{className:"absolute bottom-0 right-0 bg-blue-600 text-white rounded-full p-1 cursor-pointer hover:bg-blue-700",children:[(0,t.jsx)(d.TH,{className:"h-4 w-4"}),(0,t.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&handleAvatarUpload(a)}})]})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[e.firstName," ",e.lastName]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["@",e.username||e.email.split("@")[0]]}),(0,t.jsxs)("div",{className:"flex items-center mt-2 space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(d.bV,{className:"h-4 w-4 mr-1"}),e.email]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(d.Qu,{className:"h-4 w-4 mr-1"}),"Joined ",new Date(e.createdAt).toLocaleDateString()]}),e.website&&(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(d.I_,{className:"h-4 w-4 mr-1"}),(0,t.jsx)("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600",children:"Website"})]})]})]})]})}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("nav",{className:"flex space-x-8",children:[{id:"profile",label:"Profile Information",icon:d.tB},{id:"password",label:"Password & Security",icon:d.kh},{id:"account",label:"Account Settings",icon:d.I_}].map(e=>(0,t.jsxs)("button",{onClick:()=>j(e.id),className:"flex items-center px-1 py-2 border-b-2 font-medium text-sm ".concat(f===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)(e.icon,{className:"h-5 w-5 mr-2"}),e.label]},e.id))})}),"profile"===f&&(0,t.jsx)(c.ZH,{children:(0,t.jsxs)("form",{onSubmit:handleProfileUpdate,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),(0,t.jsx)("input",{type:"text",value:P.firstName,onChange:e=>k(s=>({...s,firstName:e.target.value})),className:"form-input",placeholder:"Enter first name"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),(0,t.jsx)("input",{type:"text",value:P.lastName,onChange:e=>k(s=>({...s,lastName:e.target.value})),className:"form-input",placeholder:"Enter last name"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,t.jsx)("input",{type:"text",value:P.username,onChange:e=>k(s=>({...s,username:e.target.value})),className:"form-input",placeholder:"Enter username"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"This will be your public username on Kushtunes"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),(0,t.jsx)("textarea",{value:P.bio,onChange:e=>k(s=>({...s,bio:e.target.value})),className:"form-input",rows:4,placeholder:"Tell us about yourself..."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),(0,t.jsx)("input",{type:"url",value:P.website,onChange:e=>k(s=>({...s,website:e.target.value})),className:"form-input",placeholder:"https://yourwebsite.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),(0,t.jsx)("input",{type:"text",value:P.location,onChange:e=>k(s=>({...s,location:e.target.value})),className:"form-input",placeholder:"City, Country"})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(c.DL,{variant:"primary",disabled:o,children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.TK,{className:"mr-2"}),"Saving..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.nQ,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})})]})}),"password"===f&&(0,t.jsx)(c.ZH,{children:(0,t.jsxs)("form",{onSubmit:handlePasswordUpdate,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:N?"text":"password",value:S.currentPassword,onChange:e=>C(s=>({...s,currentPassword:e.target.value})),className:"form-input pl-10 pr-10",placeholder:"Enter current password"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(d.kh,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>g(!N),children:N?(0,t.jsx)(d.kZ,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,t.jsx)(d.tE,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:b?"text":"password",value:S.newPassword,onChange:e=>C(s=>({...s,newPassword:e.target.value})),className:"form-input pl-10 pr-10",placeholder:"Enter new password"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(d.kh,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>y(!b),children:b?(0,t.jsx)(d.kZ,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,t.jsx)(d.tE,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:v?"text":"password",value:S.confirmPassword,onChange:e=>C(s=>({...s,confirmPassword:e.target.value})),className:"form-input pl-10 pr-10",placeholder:"Confirm new password"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(d.kh,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>w(!v),children:v?(0,t.jsx)(d.kZ,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,t.jsx)(d.tE,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(c.DL,{variant:"primary",disabled:o,children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.TK,{className:"mr-2"}),"Updating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.nQ,{className:"mr-2 h-4 w-4"}),"Update Password"]})})})]})}),"account"===f&&(0,t.jsx)(c.ZH,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account Information"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Email Address"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]}),(0,t.jsx)("div",{className:"flex items-center",children:e.isEmailVerified?(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,t.jsx)(d.nQ,{className:"h-3 w-3 mr-1"}),"Verified"]}):(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[(0,t.jsx)(d.LP,{className:"h-3 w-3 mr-1"}),"Unverified"]})})]}),(0,t.jsx)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Account Created"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]})}),(0,t.jsx)("div",{className:"flex items-center justify-between py-3",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Last Updated"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.updatedAt).toLocaleDateString()})]})})]})]}),(0,t.jsxs)("div",{className:"pt-6 border-t border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Danger Zone"}),(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-red-800",children:"Delete Account"}),(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"Permanently delete your account and all associated data. This action cannot be undone."})]}),(0,t.jsx)(c.DL,{variant:"outline",className:"border-red-300 text-red-700 hover:bg-red-50",children:"Delete Account"})]})})]})]})})]})}):(0,t.jsx)(i.o,{children:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.LP,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Profile Not Found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Unable to load your profile information."}),(0,t.jsx)(c.DL,{variant:"primary",asChild:!0,children:(0,t.jsx)(n(),{href:"/login",children:"Sign In"})})]})})})}}},function(e){e.O(0,[736,592,744],function(){return e(e.s=578)}),_N_E=e.O()}]);