"use strict";(()=>{var e={};e.id=9501,e.ids=[9501],e.modules={97352:e=>{e.exports=require("@prisma/client/runtime/library.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57147:e=>{e.exports=require("fs")},71017:e=>{e.exports=require("path")},35924:(e,t,s)=>{s.r(t),s.d(t,{headerHooks:()=>f,originalPathname:()=>S,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>p,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>T});var r={};s.r(r),s.d(r,{GET:()=>GET,POST:()=>POST});var a=s(10884),i=s(16132),u=s(95798),o=s(96810);let n=new o.PrismaClient,c={CDBABY_ALL:{name:"CD Baby (100+ Platforms)",platforms:["Spotify","Apple Music","Amazon Music","YouTube Music","Tidal","Deezer","Pandora","iTunes","Google Play Music","SoundCloud","Bandcamp","Napster","iHeartRadio","Slacker","Mixcloud","8tracks","Jango","Last.fm","Grooveshark","Rdio"],estimatedTime:"2-4 weeks",cost:"$9.95 per single, $29 per album",successRate:.95,revenueShare:.91},AMUSE_FREE:{name:"Amuse (Free - Major Platforms)",platforms:["Spotify","Apple Music","Amazon Music","YouTube Music","Deezer","Tidal"],estimatedTime:"1-2 weeks",cost:"100% FREE",successRate:.88,revenueShare:1},SPOTIFY:{name:"Spotify Direct",platforms:["Spotify"],estimatedTime:"1-2 weeks",cost:"Free (with API)",successRate:.92,revenueShare:.7},APPLE_MUSIC:{name:"Apple Music Direct",platforms:["Apple Music"],estimatedTime:"1-2 weeks",cost:"Free (with API)",successRate:.9,revenueShare:.7}};async function POST(e){try{let{releaseId:t,dsp:s,releaseData:r}=await e.json();if(!t||!s)return u.Z.json({success:!1,message:"Missing releaseId or dsp"},{status:400});let a=c[s];if(!a)return u.Z.json({success:!1,message:"Invalid DSP choice"},{status:400});let i=await n.delivery.create({data:{releaseId:t,store:a.name,status:"SUBMITTED",submittedAt:new Date,notes:`Submitted to ${a.name} via ${s}`}}),o="1-2 weeks"===a.estimatedTime?7:21;return setTimeout(async()=>{await n.delivery.update({where:{id:i.id},data:{status:"PROCESSING"}})},864e5),setTimeout(async()=>{await n.delivery.update({where:{id:i.id},data:{status:"LIVE",notes:`Successfully distributed to ${a.name}`}})},864e5*o),u.Z.json({success:!0,message:"Distribution initiated successfully",data:{id:i.id,store:a.name,status:"SUBMITTED",platforms:a.platforms,estimatedTime:a.estimatedTime,cost:a.cost,submittedAt:i.submittedAt}})}catch(e){return console.error("Distribution error:",e),u.Z.json({success:!1,message:"Internal server error"},{status:500})}}async function GET(e){try{let{searchParams:t}=new URL(e.url),s=t.get("releaseId");if(!s)return u.Z.json({success:!1,message:"Release ID is required"},{status:400});let r=await n.delivery.findMany({where:{releaseId:s},orderBy:{createdAt:"desc"}});return u.Z.json({success:!0,data:r})}catch(e){return console.error("Distribution fetch error:",e),u.Z.json({success:!1,message:"Internal server error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/distribute/route",pathname:"/api/distribute",filename:"route",bundlePath:"app/api/distribute/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/distribute/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:p,headerHooks:f,staticGenerationBailout:T}=d,S="/api/distribute/route"}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[729,6449,5798,6810],()=>__webpack_exec__(35924));module.exports=s})();