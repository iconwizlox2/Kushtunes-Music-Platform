"use strict";(()=>{var e={};e.id=2748,e.ids=[2748],e.modules={97352:e=>{e.exports=require("@prisma/client/runtime/library.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},43706:(e,s,r)=>{r.r(s),r.d(s,{headerHooks:()=>h,originalPathname:()=>g,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>y});var i={};r.r(i),r.d(i,{POST:()=>POST,PUT:()=>PUT,dynamic:()=>m,runtime:()=>c});var a=r(10884),t=r(16132),n=r(95798),o=r(96810),u=r(8192);let l=new o.PrismaClient,c="nodejs",m="force-dynamic";async function POST(e){try{let{email:s}=await e.json();if(!s)return n.Z.json({success:!1,message:"Email is required"},{status:400});let r=await l.user.findUnique({where:{email:s.toLowerCase()}});if(!r)return n.Z.json({success:!1,message:"User not found"},{status:404});if(r.isEmailVerified)return n.Z.json({success:!1,message:"Email is already verified"},{status:400});let i=(0,u.VB)(),a=`${process.env.NEXTAUTH_URL||"http://localhost:3000"}/verify-email?token=${i}&email=${encodeURIComponent(s)}`;return console.log("Email verification URL:",a),n.Z.json({success:!0,message:"Verification email sent successfully",data:{verificationUrl:a,email:r.email}})}catch(e){return console.error("Send verification error:",e),n.Z.json({success:!1,message:"Failed to send verification email"},{status:500})}}async function PUT(e){try{let{token:s,email:r}=await e.json();if(!s||!r)return n.Z.json({success:!1,message:"Token and email are required"},{status:400});let i=await l.user.findUnique({where:{email:r.toLowerCase()}});if(!i)return n.Z.json({success:!1,message:"User not found"},{status:404});if(i.isEmailVerified)return n.Z.json({success:!1,message:"Email is already verified"},{status:400});if(s.length<10)return n.Z.json({success:!1,message:"Invalid verification token"},{status:400});return await l.user.update({where:{id:i.id},data:{isEmailVerified:!0}}),n.Z.json({success:!0,message:"Email verified successfully",data:{user:{id:i.id,email:i.email,username:i.username,isEmailVerified:!0}}})}catch(e){return console.error("Email verification error:",e),n.Z.json({success:!1,message:"Email verification failed"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/auth/verify-email/route",pathname:"/api/auth/verify-email",filename:"route",bundlePath:"app/api/auth/verify-email/route"},resolvedPagePath:"/Users/wizloxssd/Downloads/kushtunes-starter/app/api/auth/verify-email/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:f,staticGenerationAsyncStorage:p,serverHooks:v,headerHooks:h,staticGenerationBailout:y}=d,g="/api/auth/verify-email/route"}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[729,6449,5798,6810,8752,8192],()=>__webpack_exec__(43706));module.exports=r})();